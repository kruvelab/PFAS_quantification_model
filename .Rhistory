# Change the admin directory
admin <- "C:/Users/MelanieLauria/Documents/GitHub/PFOA_semi_quant"
setwd(admin)
source("code/functions.R")
library(caTools)
library(tidyverse)
library(caret)
library(plotly)
library(cowplot)
cal_filename_data <-  paste0(admin,"/data/Batch 1 Semi Quant w frag.xlsx")
cal_filename_smiles <- paste0(admin,"/data/Smiles_for_Target_PFAS_semicolon.csv")
sus_filename_data <- paste0(admin,"/Melanie_new_suspects/20210810_Melanie_Suspect _Screening_TF.xlsx")
sus_filename_smiles <- paste0(admin,"/Melanie_new_suspects/suspects_smiles_melanie_updated_semicolon2.csv")
logIE_pred_model <- readRDS(paste0(admin,"/models/230329_logIE_model_withPFAS_allData.Rdata"))
melanie_concentrations_pred <- concentration_forAnalytes_model_cal_separateFile(cal_filename_data,
cal_filename_smiles,
sus_filename_data,
sus_filename_smiles,
filename_eluent = "data/eluent.csv",
pred_model =  logIE_pred_model,
compounds_to_be_removed_as_list = c("HFPO-DA", "MeFOSE", "EtFOSE", "PFHpS-br", "PFPeS", "PFHpS", "PFNS", "PFPeDA", "10:2 mono PAP", "4:2 mono PAP", "6:2 mono PAP", "8:2 mono PAP"))
cal_filename_data <-  paste0(admin,"/data_for_modeling/Batch 1 Semi Quant w frag.xlsx")
cal_filename_smiles <- paste0(admin,"/data_for_modeling/Smiles_for_Target_PFAS_semicolon.csv")
sus_filename_data <- paste0(admin,"/Melanie_new_suspects/20210810_Melanie_Suspect _Screening_TF.xlsx")
sus_filename_smiles <- paste0(admin,"/Melanie_new_suspects/suspects_smiles_melanie_updated_semicolon2.csv")
logIE_pred_model <- readRDS(paste0(admin,"/models/230329_logIE_model_withPFAS_allData.Rdata"))
melanie_concentrations_pred <- concentration_forAnalytes_model_cal_separateFile(cal_filename_data,
cal_filename_smiles,
sus_filename_data,
sus_filename_smiles,
filename_eluent = "data/eluent.csv",
pred_model =  logIE_pred_model,
compounds_to_be_removed_as_list = c("HFPO-DA", "MeFOSE", "EtFOSE", "PFHpS-br", "PFPeS", "PFHpS", "PFNS", "PFPeDA", "10:2 mono PAP", "4:2 mono PAP", "6:2 mono PAP", "8:2 mono PAP"))
#### When calibrants and suspects are in separate TraceFinder and SMILES files ####
setwd(admin)
cal_filename_data <-  paste0(admin,"/data_for_modelling/Batch 1 Semi Quant w frag.xlsx")
cal_filename_smiles <- paste0(admin,"/data_for_modelling/Smiles_for_Target_PFAS_semicolon.csv")
sus_filename_data <- paste0(admin,"/Melanie_new_suspects/20210810_Melanie_Suspect _Screening_TF.xlsx")
sus_filename_smiles <- paste0(admin,"/Melanie_new_suspects/suspects_smiles_melanie_updated_semicolon2.csv")
logIE_pred_model <- readRDS(paste0(admin,"/models/230329_logIE_model_withPFAS_allData.Rdata"))
melanie_concentrations_pred <- concentration_forAnalytes_model_cal_separateFile(cal_filename_data,
cal_filename_smiles,
sus_filename_data,
sus_filename_smiles,
filename_eluent = "data/eluent.csv",
pred_model =  logIE_pred_model,
compounds_to_be_removed_as_list = c("HFPO-DA", "MeFOSE", "EtFOSE", "PFHpS-br", "PFPeS", "PFHpS", "PFNS", "PFPeDA", "10:2 mono PAP", "4:2 mono PAP", "6:2 mono PAP", "8:2 mono PAP"))
setwd(admin)
cal_filename_data <-  paste0(admin,"/data_for_modelling/Batch 1 Semi Quant w frag.xlsx")
cal_filename_smiles <- paste0(admin,"/data_for_modelling/Smiles_for_Target_PFAS_semicolon.csv")
sus_filename_data <- paste0(admin,"/results/Melanie_new_suspects/20210810_Melanie_Suspect _Screening_TF.xlsx")
sus_filename_smiles <- paste0(admin,"/results/Melanie_new_suspects/suspects_smiles_melanie_updated_semicolon2.csv")
logIE_pred_model <- readRDS(paste0(admin,"/models/230329_logIE_model_withPFAS_allData.Rdata"))
melanie_concentrations_pred <- concentration_forAnalytes_model_cal_separateFile(cal_filename_data,
cal_filename_smiles,
sus_filename_data,
sus_filename_smiles,
filename_eluent = "data/eluent.csv",
pred_model =  logIE_pred_model,
compounds_to_be_removed_as_list = c("HFPO-DA", "MeFOSE", "EtFOSE", "PFHpS-br", "PFPeS", "PFHpS", "PFNS", "PFPeDA", "10:2 mono PAP", "4:2 mono PAP", "6:2 mono PAP", "8:2 mono PAP"))
melanie_concentrations_pred <- concentration_forAnalytes_model_cal_separateFile(cal_filename_data,
cal_filename_smiles,
sus_filename_data,
sus_filename_smiles,
filename_eluent = "data_for_modelling/eluent.csv",
pred_model =  logIE_pred_model,
compounds_to_be_removed_as_list = c("HFPO-DA", "MeFOSE", "EtFOSE", "PFHpS-br", "PFPeS", "PFHpS", "PFNS", "PFPeDA", "10:2 mono PAP", "4:2 mono PAP", "6:2 mono PAP", "8:2 mono PAP"))
warnings()
melanie_concentrations_pred_conc <- melanie_concentrations_pred$data
melanie_concentrations_pred_conc <- melanie_concentrations_pred_conc %>%
select(-c(IC, Molecular_weight, area_IC)) %>%
rename(Predicted_RF = slope_pred)
write_delim(melanie_concentrations_pred_conc, paste0(admin,"/Melanie_new_suspects/230413_new_suspects_pred_conc.csv"), delim = ";")
